<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guide: Setting Up a Webtop Remote Desktop</title>

    <!-- Prism JS for Syntax Highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" />
    
    <style>
        /* --- THEME VARIABLES & GENERAL STYLING --- */
        :root {
            --bg-color: #f8f9fa; --main-bg-color: #ffffff; --text-color: #212529;
            --heading-color: #0056b3; --link-color: #007bff; --border-color: #dee2e6;
            --code-bg: #e9ecef; --code-text: #212529; --toc-bg: #e9f5ff;
            --toc-border: #007bff; --info-bg: #fff3cd; --info-border: #ffeeba;
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.05); --pre-bg: #2d2d2d;
        }
        [data-theme="dark"] {
            --bg-color: #121212; --main-bg-color: #1e1e1e; --text-color: #e0e0e0;
            --heading-color: #61afef; --link-color: #56b6c2; --border-color: #333;
            --code-bg: #2c2c2c; --code-text: #e0e0e0; --toc-bg: #2a3b4c;
            --toc-border: #61afef; --info-bg: #3e382b; --info-border: #b08900;
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.7; margin: 0; padding: 0; background-color: var(--bg-color); color: var(--text-color); font-size: 17px; transition: background-color 0.3s, color 0.3s; }
        .container { max-width: 960px; margin: 0 auto; padding: 1rem 2rem; }
        .page-header { display: flex; justify-content: space-between; align-items: center; padding: 1rem 2rem; border-bottom: 1px solid var(--border-color); }
        main { padding: 2rem 0; }
        .content-card { background-color: var(--main-bg-color); border-radius: 12px; box-shadow: var(--shadow); padding: 2rem 3rem; }
        h1, h2, h3, h4 { color: var(--heading-color); line-height: 1.3; }
        h1 { font-size: 2.5rem; margin-bottom: 0.5rem; text-align: center; }
        h2 { font-size: 2rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.75rem; margin-top: 3rem; }
        h3 { font-size: 1.5rem; margin-top: 2.5rem; }
        p, li { font-size: 1.05rem; }
        a { color: var(--link-color); text-decoration: none; }
        a:hover { text-decoration: underline; }
        code { font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace; background-color: var(--code-bg); color: var(--code-text); padding: 0.2em 0.4em; border-radius: 4px; font-size: 0.9em; }
        pre { background-color: var(--pre-bg); padding: 1.5rem; border-radius: 8px; overflow-x: auto; position: relative; font-size: 0.95rem; line-height: 1.5; margin: 1.5rem 0; }
        pre code { background-color: transparent; padding: 0; color: #ccc; }
        .token.comment { color: #6a9955 !important; }
        .copy-button { position: absolute; top: 12px; right: 12px; background-color: #4a505c; color: #e2e2e2; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-size: 0.85rem; opacity: 0; transition: opacity 0.2s, background-color 0.2s; }
        pre:hover .copy-button { opacity: 1; }
        .copy-button:hover { background-color: #5c6370; }
        .toc, .info-box { padding: 1.5rem 2rem; margin: 2rem 0; border-left: 5px solid; border-radius: 8px; }
        .toc { background-color: var(--toc-bg); border-color: var(--toc-border); }
        .toc h3 { margin-top: 0; }
        .toc ul { padding-left: 20px; margin: 0; }
        .toc li { margin-bottom: 0.5rem; }
        .info-box { background-color: var(--info-bg); border-color: var(--info-border); }
        .info-box p:last-child, .info-box ul:last-child { margin-bottom: 0; }
        .theme-switch-wrapper { display: flex; align-items: center; }
        .theme-switch { display: inline-block; height: 24px; position: relative; width: 48px; }
        .theme-switch input { display:none; }
        .slider { background-color: #ccc; bottom: 0; cursor: pointer; left: 0; position: absolute; right: 0; top: 0; transition: .4s; }
        .slider:before { background-color: #fff; bottom: 4px; content: ""; height: 16px; left: 4px; position: absolute; transition: .4s; width: 16px; }
        input:checked + .slider { background-color: #61afef; }
        input:checked + .slider:before { transform: translateX(24px); }
        .slider.round { border-radius: 24px; }
        .slider.round:before { border-radius: 50%; }
    </style>
</head>
<body>

    <header class="page-header">
        <h4>Remote Desktop Guide</h4>
        <div class="theme-switch-wrapper">
            <span>‚òÄÔ∏è</span>
            <label class="theme-switch" for="checkbox">
                <input type="checkbox" id="checkbox" />
                <div class="slider round"></div>
            </label>
            <span>üåô</span>
        </div>
    </header>

    <div class="container">
        <main>
            <div class="content-card">
                <header style="text-align:center; margin-bottom: 3rem;">
                    <h1>Setting Up a Webtop Remote Desktop</h1>
                    <p>A Full Linux Desktop with Modern Browsers, Right in Your Browser</p>
                </header>

                <nav class="toc">
                    <h3>Table of Contents</h3>
                    <ul>
                        <li><a href="#section-1">What is Webtop?</a></li>
                        <li><a href="#section-2">Part 1: Installing Webtop with Docker</a></li>
                        <li><a href="#section-3">Part 2: Understanding the HTTPS Requirement</a></li>
                        <li><a href="#section-4">Part 3: The Solution - Securing with Nginx Proxy Manager</a></li>
                        <li><a href="#section-5">Part 4: Using Your Remote Desktop</a></li>
                        <li><a href="#section-6">Part 5: Decommissioning Webtop</a></li>
                    </ul>
                </nav>

                <section id="section-1">
                    <h2>What is Webtop?</h2>
                    <p>Webtop provides a full-featured and high-performance Linux desktop environment (XFCE) that runs in a Docker container and is accessible from any modern web browser. It comes pre-packaged with popular browsers like Firefox and Chrome, along with common desktop utilities.</p>
                    <p>This is a fantastic solution for secure browsing, accessing region-specific content, or just having a consistent desktop environment available from anywhere.</p>
                </section>
                
                <section id="section-2">
                    <h2>Part 1: Installing Webtop with Docker</h2>
                    <p>We will set up Webtop as a self-contained service, ready to be connected to our secure proxy.</p>

                    <h3>Step 1: Create the Project Directory</h3>
                    <pre><code class="language-bash"># Create a dedicated directory for the Webtop service
mkdir /root/docker-deployment/webtop
</code></pre>

                    <h3>Step 2: Create the `docker-compose.yml` File</h3>
                    <pre><code class="language-bash">nano /root/docker-deployment/webtop/docker-compose.yml
</code></pre>
                    <p>Paste the following content. This configuration sets up Webtop, exposes a port for testing, and connects it to our shared proxy network.</p>
                    <pre><code class="language-yaml">services:
  webtop:
    image: lscr.io/linuxserver/webtop:latest
    container_name: webtop
    restart: unless-stopped
    environment:
      - PUID=1000 # Standard User ID
      - PGID=1000 # Standard Group ID
      - TZ=Etc/UTC # Optional: Change to your timezone, e.g., "America/New_York"
    volumes:
      # CRITICAL: This persists your entire desktop configuration and files.
      - ./config:/config
    ports:
      # Expose port 8090 on the host to test the connection.
      - "8090:3000"
    # A full desktop requires more shared memory to prevent browser crashes.
    shm_size: '2gb'
    # Connect this service to our shared proxy network for secure access.
    networks:
      - nginx-proxy

# Declare that our shared network is external and pre-existing.
networks:
  nginx-proxy:
    external: true
</code></pre>

                    <h3>Step 3: Open Firewall Port for Testing</h3>
                    <p>Before starting, go to your VPS provider's firewall settings and create a rule to **ALLOW inbound TCP traffic on port 8090**. We will use this port only for our initial test.</p>
                
                    <h3>Step 4: Launch Webtop</h3>
                    <pre><code class="language-bash"># Navigate to the webtop directory
cd /root/docker-deployment/webtop

# Start the service
docker compose up -d
</code></pre>
                </section>

                <section id="section-3">
                    <h2>Part 2: Understanding the HTTPS Requirement</h2>
                    <p>Now that the service is running, let's see why a direct connection is not the final solution.</p>
                    <ol>
                        <li>Open your browser and navigate to <code>http://YOUR_SERVER_IP:8090</code>.</li>
                        <li>You will be greeted with a black screen and an error message: <br><code>Error: This application requires a secure connection (HTTPS). Please check the URL.</code></li>
                    </ol>
                    <div class="info-box">
                        <p>This is not a bug; it's an important security feature. Webtop is designed to prevent you from using it over an insecure connection. The correct and professional way to access it is by placing it behind Nginx Proxy Manager to provide the necessary SSL certificate (HTTPS).</p>
                    </div>
                </section>
                
                <section id="section-4">
                    <h2>Part 3: The Solution - Securing with Nginx Proxy Manager</h2>
                    <p>Follow these steps to make your Webtop instance live and secure.</p>
                    <ol>
                        <li><strong>Point a Subdomain:</strong> In your domain registrar, create a new 'A' record for a subdomain like <code>desktop.yourdomain.com</code> and point it to your server's IP.</li>
                        <li><strong>Log in to Nginx Proxy Manager.</strong></li>
                        <li><strong>Add a New Proxy Host:</strong>
                            <ul>
                                <li><strong>Details Tab:</strong>
                                    <ul>
                                        <li><strong>Domain Names:</strong> <code>desktop.yourdomain.com</code></li>
                                        <li><strong>Scheme:</strong> <code>http</code></li>
                                        <li><strong>Forward Hostname / IP:</strong> <code>webtop</code> (This MUST match the service name in the `docker-compose.yml`).</li>
                                        <li><strong>Forward Port:</strong> <code>3000</code> (The internal port of the Webtop container, not the public 8090 port).</li>
                                        <li><strong style="color: #dc3545;">IMPORTANT:</strong> Turn on <strong>"Websockets Support"</strong>.</li>
                                    </ul>
                                </li>
                                <li><strong>SSL Tab:</strong> Select "Request a new SSL Certificate" and turn on "Force SSL".</li>
                                <li><strong>Save.</strong></li>
                            </ul>
                        </li>
                        <li><strong>Clean Up Firewall (Security Step):</strong> After confirming your new secure domain works, go back to your VPS provider's firewall settings and **DELETE the rule for port 8090**. All traffic will now go securely through port 443 via the proxy manager.</li>
                    </ol>
                    <p>After about a minute, your secure remote desktop will be fully accessible at <code>https://desktop.yourdomain.com</code>.</p>
                </section>

                <section id="section-5">
                    <h2>Part 4: Using Your Remote Desktop</h2>
                    <p>Navigating to your secure URL will instantly load the desktop. There is no password by default. You can start using the pre-installed applications right away.</p>
                    <ul>
                        <li><strong>Persistent Storage:</strong> Any files you download or create on the desktop will be saved in the <code>/root/docker-deployment/webtop/config</code> folder on your server. Your browser profiles, bookmarks, and extensions are also saved here, so your session persists even after restarting the container.</li>
                        <li><strong>File Uploads:</strong> You can drag and drop files from your computer directly onto the Webtop browser window to upload them to the desktop's "Uploads" folder.</li>
                    </ul>
                </section>

                <section id="section-6">
                    <h2>Part 5: Decommissioning Webtop</h2>
                    <p>If you no longer need the remote desktop, follow these steps for a clean removal.</p>
                     <ol>
                        <li>
                            <strong>Remove the Proxy Host:</strong> In Nginx Proxy Manager, delete the proxy host you created for Webtop (e.g., `desktop.yourdomain.com`).
                        </li>
                        <li>
                            <strong>Take Down the Docker Service:</strong> Navigate to the Webtop project directory. The `-v` flag is critical as it removes the volume containing your desktop's entire configuration and files.
                            <pre><code class="language-bash">cd /root/docker-deployment/webtop
docker compose down -v
</code></pre>
                        </li>
                         <li>
                            <strong>Delete the Project Folder:</strong> Finally, remove the project directory itself.
                             <pre><code class="language-bash"># Go up one directory level
cd ..

# Be careful! This command permanently deletes the folder.
rm -rf webtop
</code></pre>
                         </li>
                    </ol>
                     <p>The Webtop remote desktop has been completely removed from your server.</p>
                </section>
            </div>
        </main>
    </div>

    <!-- Scripts at the end of the body -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- COPY BUTTON LOGIC ---
            document.querySelectorAll('pre').forEach(pre => { const code = pre.querySelector('code'); if (code) { const button = document.createElement('button'); button.innerText = 'Copy'; button.className = 'copy-button'; pre.appendChild(button); button.addEventListener('click', () => { navigator.clipboard.writeText(code.innerText).then(() => { button.innerText = 'Copied!'; setTimeout(() => { button.innerText = 'Copy'; }, 2000); }); }); } });
            // --- THEME TOGGLE LOGIC ---
            const themeToggle = document.getElementById('checkbox'); const currentTheme = localStorage.getItem('theme'); const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches; const applyTheme = (theme) => { document.documentElement.setAttribute('data-theme', theme); themeToggle.checked = theme === 'dark'; }; if (currentTheme) { applyTheme(currentTheme); } else if (prefersDark) { applyTheme('dark'); } themeToggle.addEventListener('change', function() { const theme = this.checked ? 'dark' : 'light'; document.documentElement.setAttribute('data-theme', theme); localStorage.setItem('theme', theme); });
        });
    </script>
</body>
</html>