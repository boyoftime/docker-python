<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enable Developer Mode (Auto-Reload)</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.2.0/themes/prism-okaidia.min.css" rel="stylesheet" />
    <style>
        /* SAME STYLES AS INDEX.HTML */
        :root { --bg-color: #f8f9fa; --main-bg-color: #ffffff; --text-color: #212529; --heading-color: #0056b3; --link-color: #007bff; --border-color: #dee2e6; --code-bg: #e9ecef; --code-text: #212529; --pre-bg: #2d2d2d; --shadow: 0 4px 8px rgba(0, 0, 0, 0.05); }
        [data-theme="dark"] { --bg-color: #121212; --main-bg-color: #1e1e1e; --text-color: #e0e0e0; --heading-color: #61afef; --link-color: #56b6c2; --border-color: #333; --code-bg: #2c2c2c; --code-text: #e0e0e0; --pre-bg: #2d2d2d; --shadow: 0 4px 8px rgba(0, 0, 0, 0.2); }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: var(--bg-color); color: var(--text-color); line-height: 1.7; margin: 0; padding: 2rem; transition: 0.3s; }
        .container { max-width: 900px; margin: 0 auto; background: var(--main-bg-color); padding: 2rem; border-radius: 12px; box-shadow: var(--shadow); }
        h1, h2 { color: var(--heading-color); }
        pre { background-color: var(--pre-bg); padding: 1.5rem; border-radius: 8px; overflow-x: auto; margin: 1.5rem 0; }
        code { font-family: Consolas, monospace; color: #ccc; }
        .back-link { display: inline-block; margin-bottom: 2rem; color: var(--link-color); text-decoration: none; font-weight: bold; }
        .back-link:hover { text-decoration: underline; }
        .highlight-box { background-color: #e7f5ff; border-left: 5px solid #007bff; padding: 1rem; margin: 1rem 0; color: #333; }
        [data-theme="dark"] .highlight-box { background-color: #1a2733; border-color: #61afef; color: #e0e0e0; }
    </style>
</head>
<body>

    <div class="container">
        <a href="index.html" class="back-link">&larr; Back to Main Guide</a>

        <h1>Enable Developer Mode (Auto-Reload)</h1>
        <p>By default, Docker is optimized for production, meaning it caches your Python code to run faster. However, this is annoying during development because you have to rebuild the container to see code changes.</p>
        
        <p>You can enable <strong>Developer Mode</strong> by adding specific environment variables to your <code>docker-compose.yml</code> file. This forces Flask to reload immediately when you save a file and prevents Python from creating sticky cache files.</p>

        <h2>The Configuration</h2>
        <p>Open your app's <code>docker-compose.yml</code> file and add the <code>environment</code> section as shown below:</p>

        <pre><code class="language-yaml">services:
  app_one:
    container_name: flask_app_one_app
    build: .
    restart: always
    expose:
      - "8000"
    
    # --- ADD THIS SECTION HERE ---
    environment:
      - FLASK_APP=app.py
      - FLASK_DEBUG=0             # Turn this on to switch Flask's auto-reloader
      - PYTHONDONTWRITEBYTECODE=1 # Prevents creation of .pyc files (Fixes caching issues)
      - PYTHONUNBUFFERED=1        # Shows logs in the console instantly
    # -----------------------------

    volumes:
      - ./app.py:/app/app.py
      - ./static:/app/static
      - ./templates:/app/templates
    networks:
      - nginx-proxy</code></pre>

        <h2>What These Variables Do</h2>
        <ul>
            <li><strong>FLASK_DEBUG=1:</strong> Tells Flask to watch your files. If you edit <code>app.py</code>, Flask restarts the internal server automatically.</li>
            <li><strong>PYTHONDONTWRITEBYTECODE=1:</strong> This is the most important fix. It stops Python from creating <code>__pycache__</code> folders and <code>.pyc</code> files, ensuring the container always reads your fresh code, not an old compiled version.</li>
            <li><strong>PYTHONUNBUFFERED=1:</strong> Ensures that print statements and error logs appear immediately in your Docker logs/Portainer, rather than being delayed.</li>
        </ul>

        <div class="highlight-box">
            <strong>How to Apply:</strong><br>
            After adding these lines, you must rebuild your container <strong>one last time</strong> for the settings to take effect:
            <br><code>docker compose up -d --build</code>
            <br><br>
            After that, simple restarts (or auto-reloads) will work perfectly!
        </div>

    </div>

    <!-- Syntax Highlighting Script -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Simple Dark Mode Auto-Detect
        if (localStorage.getItem('theme') === 'dark' || (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.setAttribute('data-theme', 'dark');
        }
    </script>
</body>
</html>